{% load static %}
{% block head %}

<link href = "{% static 'blog/css/index.css' %}" rel="stylesheet" type="text/css">

<style>

</style>

{% endblock %}

{% block content %}

<div id = "parent">

    <div class="menu">
        <div><a href="{% url 'Home' %}">Home</a></div>
        <div><a href="{% url 'Movies' %}">Movies</a></div>
        <div><a href="{% url 'Directors' %}">Directors</a></div>
        <div><a href="{% url 'Actors' %}">Actors</a></div>
    </div>
    <br>

    <div id = "section_name">
         {{ movie.name }}
    </div>
    <br>

    <div class = "section_separator">
        INFORMATION
    </div>
    <br>
   
    <div id = "section_information">

        <div style = "margin-left: 20%;margin-top: 15%;"> 
            <table height = 200>
                <tbody>
                    <tr>
                        <td class = "information">Rating:</td>
                        <td class = "information_value">{{ movie.rating.name }}</td>
                    </tr>
                    <tr>
                        <td class = "information">Genre:</td>
                        <td class = "information_value">
                            {% for genre in movie.genres.all %} 
                                <label>{{ genre }} </label>
                            {% endfor %}
                        </td>
                    </tr>
                    <tr>
                        <td class = "information">Language:</td>
                        <td class = "information_value"> {{ movie.language }}</td>
                    </tr>
                    <tr>
                        <td class = "information">Director:</td>
                        <td class = "information_value">{{ movie.director }}</td>
                    </tr>
                    <tr>
                        <td class = "information">Release Year:</td>
                        <td class = "information_value"> {{ movie.only_year }}</td>
                    </tr>
                    <tr>
                        <td class = "information">Runtime (minutes):</td>
                        <td class = "information_value"> {{ movie.duration }}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div>
            {{ movie.sinopsis }}
        </div>

        <div class = "images" style = "width: 65%;height: 90%;">
            <img src="{{ movie.image.url }}" style="width: 100%;height: 100%;">
            <figcaption style = "text-align: center;"> {{ movie.name }} </figcaption>
        </div>

    </div>
    <br>

    <div class = "section_separator">
        REVIEW
    </div>
    <br>

    <div id = "section_review">
        {{ movie.review }}.
    </div>
    <br>

    <div class = "section_separator">
        SCORES
    </div>
    <br>

    <div id = "section_scores">

        <div style = "margin-left: 10%;">
            <table height = 200>
                <tbody>
                    <tr>
                        <td class = "feature">Cinematography</td>
                        <td class = "score"></td>
                    </tr>
                    <tr>
                        <td class = "feature">Acting</td>
                        <td class = "score"></td>
                    </tr>
                    <tr>
                        <td class = "feature">Editing</td>
                        <td class = "score"></td>
                    </tr>
                    <tr>
                        <td class = "feature">Custom</td>
                        <td class = "score"></td>
                    </tr>
                    <tr>
                        <td class = "feature">Music</td>
                        <td class = "score"></td>
                    </tr>
                    <tr>
                        <td class = "feature">Screenplay</td>
                        <td class = "score"></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div>
            <table height = 200>
                <tbody>
                    <tr>
                        <td class = "general">Our Score</td>
                        <td class = "icon_score"></td>
                    </tr>
                    <tr>
                        <td class = "general"><img class = "icons" src = "/media/icons/RottenTomatoesIcon.png"></td>
                        <td class = "icon_score"></td>
                    </tr>
                    <tr>
                        <td class = "general"><img class = "icons" src = "/media/icons/ImdbIcon.png"></td>
                        <td class = "icon_score"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <br>

    <div class = "section_separator">
        CASTING
    </div>
    <br>

    <div id = "section_casting">
        {% for actor in movie.actors.all %}
        <div class = "images">
            <img src="{{ actor.image.url }}" style="height: 100px;width: 100%;" >
            <figcaption style = "text-align: center;"> {{ actor.name }} </figcaption>
        </div>
        {% endfor %}
    </div>
    <br>

    <div class = "section_separator">
        SCENES
    </div>
    <br>

    <div id = "section_scenes">
        {% for scene in movie.scene_movie_set.all %}
        <div class = "scenes images">
            <img src="{{ scene.image.url }}" style="width: 100%; height: 200px;" >
            <figcaption style = "text-align: center;"> {{ scene.description }} </figcaption>
        </div>
        {% endfor %}
    </div>
    <br>
    
    <div class = "section_separator">
        QUOTES
    </div>
    <br>

    <div id = "section_quotes">

        {% for quote in movie.quote_movie_set.all %}
            <div class = "quotes">
                <div>{{ quote.quote }}</div>
                <div class = "quotes_caption">- {{ quote.character.name }}</div>
            </div>
        {% endfor %}
    </div>
    <br>

    <div class = "section_separator">
        RELATED
    </div>
    <br>

    <div id = "section_related">
    </div>
</div>

<div id = "header">

</div>

<div id = "right_side">

</div>

<div id = "left_side">

</div>

<div id = "bottom">

</div>

{% endblock %}

{% block scripts %}

<script src = "{% static 'blog/js/jquery.js' %}"></script>

{{ movie.scores_json|json_script:'scores_json' }}
{{ movie.icons_scores_json|json_script:'icons_scores_json' }}

<script>

    var score_bar = function(bar_color,column,json_data){

        let features = Object.keys(json_data)

        for (let cell = 0; cell < column.length; cell++ )
        {
            let score = json_data[features[cell]]
            $(column[cell]).append($('<div class = "images">'+score+'%</div>')
                                .css({
                                    "border":"1px solid black",
                                    "height":"20px",
                                    "width":"90%",
                                    "margin-left":"5px",
                                    "text-align":"center",
                                    "background":"linear-gradient(to right, "+ bar_color +" 0" + score + "%,white " + score + "% 100%)"
                                })
                                )
        }
    }

    // accesing color of the page
    const page_color = getComputedStyle(document.documentElement).getPropertyValue('--page-color')

    var scores =jQuery.parseJSON($("#scores_json").text());
    var score_column = $(".score")
    
    var icon_scores =jQuery.parseJSON($("#icons_scores_json").text());
    var icon_score_column = $(".icon_score")

    score_bar(page_color,score_column,scores)
    score_bar(page_color,icon_score_column,icon_scores)

</script>

{% endblock %}